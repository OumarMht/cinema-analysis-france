---
title: |
  \includegraphics[height=2cm]{logo_nanterre.jpg} 
  \vspace{1cm}
  \par
  \textbf{Analyse des mod√®les cin√©matographiques r√©gionaux}
author: |
  \textbf{Oumar Mahamat}  \\ 
  \textbf{Num√©ro √©tudiant : 38018427}
date: "`r Sys.Date() - 1`"
output: 
  pdf_document:
    latex_engine: xelatex
geometry: margin=1cm
header-includes:
  - \usepackage{graphicx}
  - \usepackage{fontspec}
---




```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

  

## 1. Analyse descriptive des entr√©es et √©quipements par r√©gion

### 1.1 Distribution des entr√©es cin√©matographiques par r√©gion

### 1.2 Distribution du nombre de salles par r√©gion


```{r load-data, include=FALSE}
library(dplyr)
library(ggplot2)
library(knitr)

# Chargement des donn√©es
data <- read.csv("C:/Users/omaha/Downloads/Cinema.csv", sep = ";", header = TRUE)

# R√©sum√© descriptif par r√©gion
resume_region <- data %>%
  group_by(Region) %>%
  summarise(
    Moyenne_Entrees = round(mean(Entr, na.rm = TRUE), 2),
    Moyenne_Salles = round(mean(Salle, na.rm = TRUE), 2),
    Moyenne_Etablissements = round(mean(Etab, na.rm = TRUE), 2),
    Moyenne_Seances_Art_Essai = round(mean(Artes, na.rm = TRUE), 2),
    N = n()
  )
```


## Distribution des entr√©es par r√©gion
```{r boxplot-entrees, fig.height=4, fig.width=10}
ggplot(data, aes(x = reorder(Region, Entr, median), y = Entr, fill = Region)) +
  geom_boxplot() +
  labs(title = "Distribution des entr√©es cin√©matographiques par r√©gion",
       y = "Entr√©es (en milliers)",
       x = "R√©gion") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8),
        legend.position = "none",
        plot.title = element_text(size = 12))
```

**Interpr√©tation :** Ce graphique montre la distribution des entr√©es cin√©matographiques (en milliers) pour chaque r√©gion fran√ßaise. On observe une forte h√©t√©rog√©n√©it√© entre les r√©gions : √éle-de-France se distingue nettement avec la fr√©quentation la plus √©lev√©e et la plus grande variabilit√©, refl√©tant la concentration de population et l'offre culturelle importante. Les r√©gions Auvergne-Rh√¥ne-Alpes et Provence-Alpes-C√¥te d'Azur pr√©sentent des fr√©quentations moyennes √©lev√©es, tandis que les r√©gions comme Centre-Val de Loire et Bourgogne-Franche-Comt√© montrent des fr√©quentations plus modestes.

## Distribution du nombre de salles par r√©gion
```{r boxplot-salles, fig.height=4, fig.width=10}
ggplot(data, aes(x = reorder(Region, Salle, median), y = Salle, fill = Region)) +
  geom_boxplot() +
  labs(title = "Distribution du nombre de salles par r√©gion",
       y = "Nombre de salles",
       x = "R√©gion") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8),
        legend.position = "none",
        plot.title = element_text(size = 12))
```

**Interpr√©tation :** Ce graphique pr√©sente la distribution du nombre de salles de cin√©ma par r√©gion. On constate une corr√©lation g√©n√©rale entre le nombre de salles et la fr√©quentation. √éle-de-France domine √† nouveau avec le plus grand nombre de salles et la plus forte dispersion. Certaines r√©gions comme Nouvelle-Aquitaine et Occitanie montrent un parc de salles important mais avec une fr√©quentation relativement plus faible. Les valeurs extr√™mes indiquent des situations particuli√®res dans certaines r√©gions.

## Tableau r√©capitulatif
```{r tableau-recap}
# Cr√©ation d'un tableau r√©capitulatif plus lisible
tableau_recap <- resume_region %>%
  arrange(desc(Moyenne_Entrees)) %>%
  rename("R√©gion" = Region, "Entr√©es moy." = Moyenne_Entrees, "Salles moy." = Moyenne_Salles, 
         "√âtab. moy." = Moyenne_Etablissements, "Art & Essai moy." = Moyenne_Seances_Art_Essai, "Nb obs." = N)

kable(tableau_recap, 
      caption = "Indicateurs cin√©matographiques par r√©gion (classement par fr√©quentation)",
      align = c('l', 'r', 'r', 'r', 'r', 'r'))
```

**Interpr√©tation :** Ce tableau synth√©tise les indicateurs cl√©s par r√©gion, class√©es par ordre d√©croissant de fr√©quentation. Il confirme les observations graphiques et identifie les r√©gions les plus dynamiques en termes de fr√©quentation, d'√©quipement et d'offre culturelle (s√©ances art et essai).


## 2. Analyse d√©partementale de la fr√©quentation

### 2.1 Distribution des entr√©es par d√©partement

### 2.2 Caract√©ristiques de la distribution (asym√©trie, moyenne, m√©diane)

### 2.3 Identification des d√©partements extr√™mes


```{r distribution-frequentation, fig.height=6, fig.width=10, echo=FALSE, warning=FALSE}
library(tidyverse)
library(ggrepel)

# Statistiques descriptives
frequentation_stats <- data %>%
  summarise(
    Moyenne_Entr = mean(Entr, na.rm = TRUE),
    Mediane_Entr = median(Entr, na.rm = TRUE)
  )

# D√©partements extr√™mes (top 5 et bottom 5)
top_bottom <- data %>%
  arrange(desc(Entr)) %>%
  slice(c(1:5, (n()-4):n()))

# Histogramme de la distribution
ggplot(data, aes(x = Entr)) +
  geom_histogram(binwidth = 0.5, fill = "#2E8B57", color = "black", alpha = 0.7) +
  geom_vline(aes(xintercept = mean(Entr, na.rm = TRUE)), color = "red", linetype = "dashed", size = 1) +
  geom_vline(aes(xintercept = median(Entr, na.rm = TRUE)), color = "blue", linetype = "dashed", size = 1) +
  geom_text_repel(data = top_bottom, aes(x = Entr, y = 1, label = NomDep),
                  angle = 45, nudge_y = 1, size = 3, segment.color = "grey50") +
  theme_minimal(base_size = 13) +
  labs(
    title = "Distribution des entr√©es par d√©partement",
    subtitle = "Ligne rouge = Moyenne | Ligne bleue = M√©diane | √âtiquettes = d√©partements extr√™mes",
    x = "Nombre d'entr√©es (millions)",
    y = "Nombre de d√©partements"
  )
```

## Interpr√©tation de la distribution

### üìà **Caract√©ristiques de la distribution**

**Forme g√©n√©rale** :
- Distribution asym√©trique avec une longue queue √† droite
- Majorit√© des d√©partements concentr√©s dans les faibles fr√©quentations
- Quelques d√©partements pr√©sentent des valeurs exceptionnellement √©lev√©es

**Mesures de tendance centrale** :
- **Moyenne** (ligne rouge) : environ `r round(frequentation_stats$Moyenne_Entr, 2)` millions d'entr√©es
- **M√©diane** (ligne bleue) : environ `r round(frequentation_stats$Mediane_Entr, 2)` millions d'entr√©es
- L'√©cart entre moyenne et m√©diane confirme la pr√©sence de valeurs extr√™mes

###  **D√©partements remarquables**

**D√©partements √† tr√®s haute fr√©quentation** :
- **Paris** et sa r√©gion
- **Grandes m√©tropoles** r√©gionales
- Zones touristiques littorales

**D√©partements √† faible fr√©quentation** :
- Zones rurales peu dens√©ment peupl√©es
- Territoires √©loign√©s des grands centres urbains


**Conclusion** : Cette distribution confirme et quantifie les importantes disparit√©s territoriales mises en √©vidence dans les analyses pr√©c√©dentes, renfor√ßant la n√©cessit√© d'approches diff√©renci√©es selon les types de territoires.


## 3. Analyse de la p√©n√©tration des multiplexes

### 3.1 Pourcentage de d√©partements sans multiplexe par r√©gion

### 3.2 Typologie des r√©gions selon l‚Äô√©quipement en multiplexes

### 3.3 Cartographie des zones sous-√©quip√©es


```{r analyse-multiplex, fig.height=6, fig.width=10, echo=FALSE, warning=FALSE}
library(tidyverse)

# Comptage des d√©partements sans multiplexe
sans_multiplex <- data %>%
  filter(Multi == 0) %>%
  count(Region) %>%
  rename(Departements_sans_Multi = n)

# Pourcentage de d√©partements sans multiplex par r√©gion
total_par_region <- data %>%
  group_by(Region) %>%
  summarise(Total_Dep = n())

sans_multiplex <- sans_multiplex %>%
  left_join(total_par_region, by = "Region") %>%
  mutate(Pourcentage = Departements_sans_Multi / Total_Dep * 100)

# Visualisation : barplot des d√©partements sans multiplex
ggplot(sans_multiplex, aes(x = reorder(Region, -Pourcentage), y = Pourcentage)) +
  geom_col(fill = "#FF6347", color = "black", alpha = 0.8) +
  geom_text(aes(label = paste0(round(Pourcentage, 1), "%")), vjust = -0.5, size = 3.5) +
  theme_minimal(base_size = 12) +
  labs(
    title = "R√©partition des d√©partements sans multiplex par r√©gion",
    subtitle = "Pourcentage de d√©partements sans multiplex par r√©gion fran√ßaise",
    x = "R√©gion",
    y = "Pourcentage de d√©partements sans multiplex (%)"
  ) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


###  **Analyse r√©gionale de l'√©quipement en multiplexes**

**R√©gions les plus sous-√©quip√©es** (taux > 80%) :
- Bretagne, Occitanie, Centre-Val-de-Loire
- Profil : R√©gions √† dominante rurale ou avec des p√¥les urbains dispers√©s
- Enjeu : Manque d'infrastructures cin√©matographiques modernes

**R√©gions moyennement √©quip√©es** (taux 50-80%) :
- Auvergne-Rh√¥ne-Alpes, Grand-Est, Hauts-de-France
- Profil : Mixit√© urbain-rural avec quelques p√¥les majeurs
- Enjeu : √âquipement in√©gal entre m√©tropoles et zones p√©riph√©riques

**R√©gions mieux √©quip√©es** (taux < 50%)

**Conclusion** : La carte des multiplexes r√©v√®le une fracture territoriale importante dans l'√©quipement cin√©matographique moderne, avec des r√©gions enti√®res laiss√©es en marge des investissements en salles multiplexes. 




## 4. Analyse √©volutive de la fr√©quentation (2001‚Äì2002)

### 4.1 √âvolution interannuelle par d√©partement



```{r evolution-frequentation, fig.height=7, fig.width=12, echo=FALSE, warning=FALSE}
library(tidyverse)
library(ggrepel)

# Pr√©parer les donn√©es
data_long <- data %>%
  dplyr::mutate(
    Evol_sign = case_when(
      Evol > 0 ~ "Hausse",
      Evol < 0 ~ "Baisse", 
      TRUE ~ "Stable"
    ),
    Entr_2001 = Entr - Evol  # estimation des entr√©es 2001
  ) %>%
  dplyr::select(NomDep, Entr, Evol, Evol_sign, Entr_2001) %>%
  pivot_longer(
    cols = c("Entr_2001", "Entr"),
    names_to = "Annee",
    values_to = "Entrees"
  ) %>%
  dplyr::mutate(Annee = ifelse(Annee == "Entr_2001", "2001", "2002"))

# Identifier les d√©partements extr√™mes pour labels
top_extremes <- data %>%
  dplyr::arrange(desc(abs(Evol))) %>%
  dplyr::slice(1:5) %>%
  dplyr::pull(NomDep)

# Visualisation
ggplot(data_long, aes(x = reorder(NomDep, Entrees), y = Entrees, fill = Annee)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8)) +
  geom_hline(yintercept = 0, color = "red", linetype = "dashed", size = 1) +
  geom_text_repel(
    data = subset(data_long, NomDep %in% top_extremes & Annee == "2002"),
    aes(label = NomDep),
    size = 3,
    nudge_y = 0.5,
    segment.color = "grey50"
  ) +
  scale_fill_manual(values = c("2001" = "skyblue", "2002" = "orange")) +
  labs(
    title = "√âvolution de la fr√©quentation par d√©partement (2001 vs 2002)",
    x = "D√©partements",
    y = "Nombre d'entr√©es (millions)",
    fill = "Ann√©e"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank()
  )
```



### **Analyse **


- La majorit√© des d√©partements pr√©sentent une √©volution mod√©r√©e entre 2001 et 2002
- Peu de variations brutales observ√©es sur l'ensemble du territoire

**D√©partements √† forte dynamique** :
- Certains territoires montrent des progressions significatives
- D'autres connaissent des reculs notables






## 5. Analyse de la capacit√© moyenne des salles

### 5.1 Distribution des capacit√©s par r√©gion et d√©partement

### 5.2 Comparaison avec la moyenne nationale

### 5.3 D√©partements aux capacit√©s exceptionnelles


```{r capacite-salles, fig.height=7, fig.width=12, echo=FALSE, warning=FALSE}
library(tidyverse)
library(ggrepel)

# Calcul de la capacit√© moyenne par salle
data <- data %>%
  mutate(Capacite_moy_salle = Faut / Salle)

# Identifier les d√©partements extr√™mes pour annotation
extremes <- data %>%
  arrange(desc(Capacite_moy_salle)) %>%
  slice(1:5)  # top 5 d√©partements

# Violin + points
ggplot(data, aes(x = Region, y = Capacite_moy_salle, color = Region)) +
  geom_violin(alpha = 0.3, fill = NA) +           # distribution par r√©gion
  geom_jitter(width = 0.2, size = 2, alpha = 0.8) + # points pour chaque d√©partement
  geom_hline(yintercept = mean(data$Capacite_moy_salle, na.rm = TRUE), 
             linetype = "dashed", color = "red", size = 1) +
  geom_text_repel(
    data = extremes,
    aes(x = Region, y = Capacite_moy_salle, label = NomDep),
    nudge_x = 0.3,
    size = 3,
    show.legend = FALSE
  ) +
  labs(
    title = "Capacit√© moyenne des salles par r√©gion",
    subtitle = "Distribution des capacit√©s par d√©partement avec ligne rouge = moyenne nationale",
    x = "R√©gion",
    y = "Capacit√© moyenne (fauteuils/salle)",
    color = "R√©gion"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "bottom",
    axis.text.x = element_text(angle = 45, hjust = 1)
  )
```


###  **Indicateurs statistiques descriptifs**

```{r stats-capacite, echo=FALSE}
stats_capacite <- data %>%
  summarise(
    Moyenne_Nationale = mean(Capacite_moy_salle, na.rm = TRUE),
    Median_Nationale = median(Capacite_moy_salle, na.rm = TRUE),
    Ecart_Type = sd(Capacite_moy_salle, na.rm = TRUE),
    Coefficient_Variation = (Ecart_Type / Moyenne_Nationale) * 100,
    Min_Capacite = min(Capacite_moy_salle, na.rm = TRUE),
    Max_Capacite = max(Capacite_moy_salle, na.rm = TRUE)
  )

stats_region <- data %>%
  group_by(Region) %>%
  summarise(
    Moyenne_Region = mean(Capacite_moy_salle, na.rm = TRUE),
    Ecart_Moyenne_Nationale = Moyenne_Region - stats_capacite$Moyenne_Nationale
  ) %>%
  arrange(desc(Moyenne_Region))

cat("Capacit√© moyenne nationale :", round(stats_capacite$Moyenne_Nationale, 1), "fauteuils/salle\n")
cat("√âcart-type :", round(stats_capacite$Ecart_Type, 1), "fauteuils/salle\n")
cat("Coefficient de variation :", round(stats_capacite$Coefficient_Variation, 1), "%\n")
```

## Interpr√©tation des r√©sultats

###  **Analyse de la distribution des capacit√©s**

**Dispersion g√©ographique** :
- Variabilit√© importante entre et au sein des r√©gions
- Certaines r√©gions montrent une distribution homog√®ne
- D'autres pr√©sentent une grande h√©t√©rog√©n√©it√© interne

**Positionnement relatif** :
- R√©gions structurellement au-dessus de la moyenne nationale
- R√©gions syst√©matiquement en-dessous du benchmark national
- √âcarts significatifs entre territoires comparables

###  **D√©partements aux capacit√©s exceptionnelles**

**D√©partements √† haute capacit√©** :
- Infrastructures modernes et r√©centes
- Pr√©sence de multiplexes de grande taille













## 6. Analyse de l‚Äôintensit√© d‚Äôutilisation des salles

### 6.1 S√©ances par salle selon la taille des d√©partements

### 6.2 Tableau des d√©partements aux performances remarquables

### 6.3 Statistiques descriptives par quartile de population

### 6.4 Mesure de l‚Äôefficience op√©rationnelle


```{r intensite-utilisation, fig.height=7, fig.width=12, echo=FALSE, warning=FALSE}
library(tidyverse)
library(ggplot2)

# Calcul de l'intensit√© d'utilisation
data <- data %>%
  mutate(Sessions_par_salle = Sean / Salle)  # s√©ances par salle

# Cr√©ation de groupes selon la taille de la population (quartiles)
data <- data %>%
  mutate(Pop_group = ntile(Pop, 4))  # 1 = plus petit quartile, 4 = plus grand

# Renommer les groupes pour plus de clart√©
data$Pop_group <- factor(data$Pop_group,
                         levels = 1:4,
                         labels = c("Q1 (petit)", "Q2", "Q3", "Q4 (grand)"))

# Statistiques par groupe
stats_group <- data %>%
  group_by(Pop_group) %>%
  summarise(
    Moyenne = mean(Sessions_par_salle, na.rm = TRUE),
    Mediane = median(Sessions_par_salle, na.rm = TRUE),
    SD = sd(Sessions_par_salle, na.rm = TRUE),
    n = n()
  )

# Visualisation am√©lior√©e avec l√©gendes explicites
ggplot(data, aes(x = Pop_group, y = Sessions_par_salle)) +
  geom_boxplot(fill = "skyblue", alpha = 0.6, outlier.color = "red") +
  geom_jitter(width = 0.15, alpha = 0.5, color = "darkblue") +
  stat_summary(fun = mean, geom = "point", shape = 18, size = 3, color = "orange") +
  annotate("text", x = 1, y = max(data$Sessions_par_salle, na.rm = TRUE),
           label = "Boxplot bleu clair = distribution des d√©partements", hjust = 0, size = 3.5, color = "blue") +
  annotate("text", x = 1, y = max(data$Sessions_par_salle, na.rm = TRUE)*0.95,
           label = "Points bleu fonc√© = chaque d√©partement", hjust = 0, size = 3.5, color = "darkblue") +
  annotate("text", x = 1, y = max(data$Sessions_par_salle, na.rm = TRUE)*0.90,
           label = "Point orange = moyenne du quartile", hjust = 0, size = 3.5, color = "orange") +
  annotate("text", x = 1, y = max(data$Sessions_par_salle, na.rm = TRUE)*0.85,
           label = "Points rouges = outliers (d√©partements atypiques)", hjust = 0, size = 3.5, color = "red") +
  labs(
    title = "Intensit√© d'utilisation des salles par taille de d√©partement",
    subtitle = "S√©ances par salle selon les quartiles de population",
    x = "Quartile de population",
    y = "S√©ances par salle (milliers)"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5)
  )
```

## Interpr√©tation des r√©sultats

###  **Analyse des distributions par quartile**

**Variabilit√© intra-groupe** :
- Dispersion significative observ√©e dans tous les quartiles
- √âcarts importants entre d√©partements de m√™me taille d√©mographique
- Pr√©sence d'outliers dans plusieurs cat√©gories

**Tendances inter-quartiles** :
- Diff√©rences structurelles entre groupes de population
- Performances relatives des diff√©rents segments d√©mographiques
- Homog√©n√©it√©/h√©t√©rog√©n√©it√© variable selon les quartiles

### **D√©partements aux performances remarquables**

```{r tableau-performances, echo=FALSE}
departements_remarquables <- data %>%
  filter(NomDep %in% c("PARIS", "RHIN-BAS", "INDRE", "ILLE-ET-VILAINE")) %>%
  select(D√©partement = NomDep, 
         "S√©ances par salle" = Sessions_par_salle, 
         "Groupe population" = Pop_group) %>%
  arrange(desc(`S√©ances par salle`))

knitr::kable(departements_remarquables, 
             caption = "D√©partements aux intensit√©s d'utilisation remarquables")
```

**Analyse des cas particuliers** :  
- **PARIS** : Performance exceptionnelle dans le quartile sup√©rieur  
- **RHIN-BAS** : Forte intensit√© d'utilisation notable  
- **INDRE** : Performance remarquable dans le petit quartile  
- **ILLE-ET-VILAINE** : Bonne intensit√© dans le grand quartile


###  **Statistiques descriptives par quartile**

```{r stats-intensite, echo=FALSE}
stats_detaillees <- data %>%
  group_by(Pop_group) %>%
  summarise(
    "Moyenne s√©ances/salle" = round(mean(Sessions_par_salle, na.rm = TRUE), 3),
    "M√©diane s√©ances/salle" = round(median(Sessions_par_salle, na.rm = TRUE), 3),
    "√âcart-type" = round(sd(Sessions_par_salle, na.rm = TRUE), 3),
    "Nombre d√©partements" = n(),
    .groups = 'drop'
  )

knitr::kable(stats_detaillees, 
             caption = "Statistiques d'intensit√© d'utilisation par quartile de population")
```


**Conclusion** :On constate que la population explique largement l'√©quipement cin√©matographique, mais l'intensit√© d'utilisation des salles varie significativement entre territoires de taille comparable.







## 7. Analyse des corr√©lations d√©mographiques et √©conomiques

### 7.1 Matrice de corr√©lations entre variables cl√©s

### 7.2 Relation Population ‚Äì Nombre d‚Äô√©tablissements

### 7.3 Relation Population ‚Äì Recettes



```{r analyse-demographique, fig.height=7, fig.width=12, echo=FALSE, warning=FALSE}
library(tidyverse)
library(broom)
library(ggrepel)
library(corrplot)

# --- 1. PR√âPARATION DES DONN√âES ---
#cat("üîç PR√âPARATION DES DONN√âES D√âMOGRAPHIQUES\n")
# Cr√©ation d'indicateurs d√©mographiques et structurels
data_demo <- data %>%
  mutate(
    Densite_pop = Pop / Comm,
    Salles_par_habitant = Salle / Pop,
    Etabs_par_habitant = Etab / Pop
  )

# --- 2. MATRICE DE CORR√âLATIONS AVEC TESTS DE SIGNIFICATIVIT√â ---
cat("\n MATRICE DE CORR√âLATIONS AVEC SIGNIFICATIVIT√â\n")

# Variables s√©lectionn√©es pour l'analyse
vars_correlation <- c("Pop", "Densite_pop", "Salle", "Etab", "Multi", "Rece")

# Calcul des corr√©lations
cor_demo <- data_demo %>%
  dplyr::select(all_of(vars_correlation)) %>%
  cor(use = "complete.obs")

# Fonction pour calculer les p-values des corr√©lations
cor.mtest <- function(mat, conf.level = 0.95) {
  mat <- as.matrix(mat)
  n <- ncol(mat)
  p.mat <- matrix(NA, n, n)
  diag(p.mat) <- 0
  for (i in 1:(n - 1)) {
    for (j in (i + 1):n) {
      tmp <- cor.test(mat[, i], mat[, j], conf.level = conf.level)
      p.mat[i, j] <- p.mat[j, i] <- tmp$p.value
    }
  }
  colnames(p.mat) <- rownames(p.mat) <- colnames(mat)
  p.mat
}

# Calcul des p-values
p_values <- cor.mtest(data_demo %>% dplyr::select(all_of(vars_correlation)))

# Visualisation de la matrice de corr√©lations
corrplot(cor_demo, 
         method = "color", 
         type = "upper", 
         order = "original",
         tl.cex = 0.8,
         p.mat = p_values,
         sig.level = c(0.001, 0.01, 0.05),
         insig = "label_sig",
         title = "Matrice de corr√©lations - Variables d√©mographiques et √©quipement")
```

##  Interpr√©tation de la matrice de corr√©lations

**Relations statistiquement significatives :**

### **Corr√©lations FORTES (r > 0.7)**
- **Population ‚Üî √âtablissements** : `r round(cor_demo["Pop", "Etab"], 3)`***
- **Population ‚Üî Salles** : `r round(cor_demo["Pop", "Salle"], 3)`***
- **Population ‚Üî Recettes** : `r round(cor_demo["Pop", "Rece"], 3)`***
- **Salles ‚Üî Recettes** : `r round(cor_demo["Salle", "Rece"], 3)`***

**Interpr√©tation** : La taille d√©mographique est fortement li√©e √† l'√©quipement cin√©matographique et aux performances √©conomiques.

### **Corr√©lations MOD√âR√âES (0.3 < r < 0.7)**
- **√âtablissements ‚Üî Recettes** : `r round(cor_demo["Etab", "Rece"], 3)`***
- **Multiplexes ‚Üî Population** : `r round(cor_demo["Multi", "Pop"], 3)`***

**Interpr√©tation** : La pr√©sence de multiplexes est mod√©r√©ment corr√©l√©e avec la population, sugg√©rant des strat√©gies d'implantation sp√©cifiques.

### **Corr√©lations FAIBLES (r < 0.3)**
- **Densit√© population ‚Üî √âquipement** : Relations g√©n√©ralement faibles

**Interpr√©tation** : La densit√© de population n'est pas un d√©terminant majeur de l'√©quipement ou des recettes.



```{r relation-population-etablissements, fig.height=6, fig.width=10, echo=FALSE}
# --- 3. RELATION POPULATION - √âTABLISSEMENTS ---
cat("\n RELATION POPULATION - √âTABLISSEMENTS\n")

modele_etabs <- lm(Etab ~ Pop, data = data)
summary_etabs <- summary(modele_etabs)
r_squared_etabs <- round(summary_etabs$r.squared, 3)
p_value_etabs <- round(summary_etabs$coefficients[2,4], 4)

# S√©lectionner les 15 d√©partements les plus int√©ressants
data_selected_etabs <- data %>%
  mutate(
    residus = abs(residuals(modele_etabs)),
    score = rank(Pop) + rank(Etab) + rank(residus)
  ) %>%
  arrange(desc(score)) %>%
  head(15)

# Graphique avec intervalle de confiance
plot_etabs <- ggplot() +
  geom_point(data = data, aes(x = Pop, y = Etab), color = "darkgreen", alpha = 0.7, size = 2) +
  geom_point(data = data_selected_etabs, aes(x = Pop, y = Etab), color = "red", size = 3) +
  geom_smooth(data = data, aes(x = Pop, y = Etab), method = "lm", se = TRUE, 
              color = "orange", fill = "orange", alpha = 0.2) +
  geom_text_repel(
    data = data_selected_etabs,
    aes(x = Pop, y = Etab, label = NomDep), 
    size = 3, 
    max.overlaps = 20,
    box.padding = 0.3,
    force = 1
  ) +
  labs(
    title = paste("Relation Population - √âtablissements (R¬≤ =", r_squared_etabs, ")"),
    x = "Population (millions d'habitants)",
    y = "Nombre d'√©tablissements",
    subtitle = paste("p-value =", p_value_etabs, "- Intervalle de confiance √† 95%")
  ) +
  theme_minimal()

print(plot_etabs)
```

##  Interpr√©tation de la relation Population - √âtablissements

**Relation lin√©aire significative :**  
- **R¬≤ = `r r_squared_etabs`** : La population explique `r round(r_squared_etabs * 100, 1)`% de la variance du nombre d'√©tablissements  
- **p-value = `r p_value_etabs`** : Relation hautement significative (p < 0.001)  
- **Pente positive** : Chaque million d'habitants suppl√©mentaire correspond √† environ `r round(summary_etabs$coefficients[2,1], 1)` √©tablissements suppl√©mentaires


**D√©partements remarquables :**

### **Au-DESSUS de la tendance (points rouges)**
- Sur-√©quipement relatif par rapport √† leur population

### **Sur la TENDANCE (points verts)**
- Ad√©quation entre √©quipement et population

### **En-DESSOUS de la tendance**
- Sous-√©quipement relatif
- Territoires prioritaires pour le d√©veloppement culturel

**Intervalle de confiance** : La zone orange montre l'incertitude autour de la tendance moyenne, plus large aux extr√™mes de population.

```{r relation-population-recettes, fig.height=6, fig.width=10, echo=FALSE}
# --- 4. RELATION POPULATION - RECETTES ---
cat("\n RELATION POPULATION - RECETTES\n")

modele_rece <- lm(Rece ~ Pop, data = data)
summary_rece <- summary(modele_rece)
r_squared_rece <- round(summary_rece$r.squared, 3)
p_value_rece <- round(summary_rece$coefficients[2,4], 4)

# S√©lectionner les 15 d√©partements les plus int√©ressants
data_selected_rece <- data %>%
  mutate(
    residus = abs(residuals(modele_rece)),
    score = rank(Pop) + rank(Rece) + rank(residus)
  ) %>%
  arrange(desc(score)) %>%
  head(15)

# Graphique avec intervalle de confiance
plot_rece <- ggplot() +
  geom_point(data = data, aes(x = Pop, y = Rece), color = "brown", alpha = 0.7, size = 2) +
  geom_point(data = data_selected_rece, aes(x = Pop, y = Rece), color = "blue", size = 3) +
  geom_smooth(data = data, aes(x = Pop, y = Rece), method = "lm", se = TRUE, 
              color = "darkgreen", fill = "darkgreen", alpha = 0.2) +
  geom_text_repel(
    data = data_selected_rece,
    aes(x = Pop, y = Rece, label = NomDep), 
    size = 3, 
    max.overlaps = 20,
    box.padding = 0.3,
    force = 1
  ) +
  labs(
    title = paste("Relation Population - Recettes (R¬≤ =", r_squared_rece, ")"),
    x = "Population (millions d'habitants)",
    y = "Recettes (millions ‚Ç¨)",
    subtitle = paste("p-value =", p_value_rece, "- Intervalle de confiance √† 95%")
  ) +
  theme_minimal()

print(plot_rece)
```

 
##  Interpr√©tation de la relation Population ‚Äì Recettes

- **R¬≤ = `r r_squared_rece`** : la population explique `r round(r_squared_rece * 100, 1)` % de la variance des recettes.  
- **p-value = `r p_value_rece`** : relation hautement significative (p < 0.001).  
- **Pente estim√©e** : chaque million d‚Äôhabitants correspond √† environ `r round(summary_rece$coefficients[2,1], 1)` M‚Ç¨ de recettes suppl√©mentaires.  

**Distribution selon les couleurs du graphique :**

###  **Points bleus (surperformants √©conomiques)**
- D√©partements dont les recettes sont sup√©rieures √† la tendance moyenne pr√©vue par le mod√®le ‚Äî ils se distinguent par une performance √©conomique plus √©lev√©e que la moyenne.

###  **Points bruns (performances conformes)**
- D√©partements dont les recettes sont globalement coh√©rentes avec la tendance moyenne ; ils illustrent un √©quilibre entre population et recettes.

### **Autres points (sous-performants)**
- D√©partements dont les recettes sont inf√©rieures √† la tendance estim√©e, traduisant un potentiel d‚Äôexploitation plus faible ou des facteurs contextuels d√©favorables.

**Remarque statistique :**
- La relation n‚Äôest pas parfaitement lin√©aire ‚Äî certains petits d√©partements g√©n√®rent des recettes disproportionn√©es.






## 8. Analyse en Composantes Principales (ACP)

### 8.1 Pr√©paration des donn√©es et valeurs propres

### 8.2 Crit√®re de Kaiser et s√©lection des axes

### 8.3 Cercle des corr√©lations : interpr√©tation des dimensions

### 8.4 Projection des d√©partements sur le plan factoriel




```{r acp-complete, fig.height=8, fig.width=12, echo=FALSE, warning=FALSE}
library(tidyverse)
library(FactoMineR)
library(factoextra)
library(corrplot)
library(ggrepel)

# --- 1Ô∏è‚É£ PR√âPARATION DES DONN√âES ---
#cat("üîç PR√âPARATION DES DONN√âES\n")

# S√©lection des variables quantitatives pour ACP
vars_acp <- data %>%
  dplyr::select(Pop, Entr, Rece, Sean, Comm, Etab, Salle, Faut, Artes, Multi)

# V√©rification des donn√©es manquantes
#cat("Donn√©es manquantes :", sum(is.na(vars_acp)), "\n")

# Centrage-r√©duction obligatoire pour ACP norm√©e
vars_acp_scaled <- scale(vars_acp)

# ---  R√âALISATION DE L'ACP NORME√â ---
#cat("\n R√âALISATION DE L'ACP NORME√â\n")

res_acp <- PCA(vars_acp_scaled, scale.unit = TRUE, graph = FALSE)

# ---  ANALYSE DES VALEURS PROPRES ET S√âLECTION DES AXES ---
#cat("\n ANALYSE DES VALEURS PROPRES\n")

eig_vals <- res_acp$eig
#cat("Valeurs propres (Œª) :\n")
#print(round(eig_vals, 3))

# Application du CRIT√àRE DE KAISER (Œª ‚â• 1)
n_axes_kaiser <- sum(eig_vals[,1] >= 1)
#cat("\n CRIT√àRE DE KAISER :", n_axes_kaiser, "axes √† retenir (Œª ‚â• 1)\n")

# Pourcentage d'inertie cumul√©e
inertie_cumulee <- cumsum(eig_vals[,2])
variance_axes_1_2 <- round(sum(eig_vals[1:2, 2]), 1)
#cat("Inertie cumul√©e axes 1-2 :", variance_axes_1_2, "%\n")

# Graphique des valeurs propres (√©boulis) avec annotation
plot_eboulis <- fviz_eig(res_acp, 
                         addlabels = TRUE, 
                         ylim = c(0, 80),
                         barfill = "#4E84C4",
                         barcolor = "#4E84C4",
                         main = "√âboulis des valeurs propres - Crit√®re de Kaiser",
                         subtitle = "Ligne rouge : Œª = 1 (seuil de Kaiser)") +
  geom_hline(yintercept = 100/ncol(vars_acp), 
             linetype = "dashed", 
             color = "red", 
             size = 1) +
  annotate("text", x = n_axes_kaiser + 0.5, y = 12, 
           label = "Seuil Kaiser", color = "red", size = 4) +
  annotate("text", x = 1.5, y = 40, 
           label = paste("Variance expliqu√©e axes 1-2 :", variance_axes_1_2, "%"),
           color = "darkblue", size = 5, fontface = "bold")

print(plot_eboulis)
```

##  Interpr√©tation de l'√©boulis des valeurs propres
**Structure dimensionnelle de l'analyse :**  
- **Axe 1** : Explique 77.8% de la variance totale ‚Üí dimension majeure  
- **Axe 2** : Explique 12.8% de la variance ‚Üí dimension secondaire mais significative  
- **Plan 1-2** : Capture 90.6% de l'information totale ‚Üí repr√©sentation excellente

**Application du crit√®re de Kaiser :**  
- Seuls **2 axes** pr√©sentent une valeur propre sup√©rieure ou √©gale 1 (seuil de Kaiser)  
- Les axes 3 √† 10 apportent une information r√©siduelle n√©gligeable  
- **Conclusion** : On garde le plan factoriel 1-2, ce qui suffit pour analyser la structure des donn√©es



```{r cercle-correlations, fig.height=7, fig.width=10, echo=FALSE}
# ---  CERCLE DES CORR√âLATIONS ---
cat("\n CERCLE DES CORR√âLATIONS\n")

# Contribution des variables aux axes
var_contrib <- res_acp$var$contrib
var_cos2 <- res_acp$var$cos2
var_coord <- res_acp$var$coord

# Variables bien repr√©sent√©es (cos¬≤ > 0.5 sur au moins un axe)
variables_biens_representees <- rownames(var_cos2)[apply(var_cos2[,1:2] > 0.5, 1, any)]
cat("Variables bien repr√©sent√©es (cos¬≤ > 0.5) :", 
    paste(variables_biens_representees, collapse = ", "), "\n")

# Cercle des corr√©lations avec qualit√© de repr√©sentation
plot_correlations <- fviz_pca_var(res_acp,
                                  col.var = "cos2",
                                  gradient.cols = c("#999999", "#E7B800", "#FC4E07"),
                                  repel = TRUE,
                                  title = "Cercle des corr√©lations - Qualit√© de repr√©sentation",
                                  subtitle = "Couleur selon cos¬≤ (qualit√© de projection)") +
  theme_minimal()

print(plot_correlations)
```

##  Interpr√©tation du cercle des corr√©lations

**Structure des relations entre variables :**

### **Axe 1 (77.8% de variance) - Dimension "Taille et √âquipement"**
- **P√¥le POSITIF** (droite) : 
  - `Pop`, `Entr`, `Rece`, `Sean`, `Salle`, `Faut`, `Multi`
  - **Interpr√©tation** : Variables de taille d√©mographique, fr√©quentation et √©quipement moderne
- **P√¥le N√âGATIF** (gauche) :
  - `Comm`, `Artes`
  - **Interpr√©tation** : Variables de densit√© territoriale et cin√©ma culturel

### **Axe 2 (12.8% de variance) - Dimension "Type d'Exploitation"**
- **P√¥le POSITIF** (haut) :
  - `Comm`, `Artes`, `Etab`
  - **Interpr√©tation** : Mod√®le de proximit√©, cin√©ma art et essai, √©tablissements diversifi√©s
- **P√¥le N√âGATIF** (bas) :
  - `Multi`, `Salle`
  - **Interpr√©tation** : Mod√®le de concentration, multiplexes, grandes salles

**Qualit√© de repr√©sentation :**
- Toutes les variables pr√©sentent un **cos¬≤ √©lev√©** (couleurs chaudes)
- Excellente repr√©sentation sur le plan factoriel



```{r projection-departements, fig.height=7, fig.width=10, echo=FALSE}
# ---  PROJECTION DES INDIVIDUS AVEC QUALIT√â ---
cat("\n PROJECTION DES D√âPARTEMENTS\n")

# Qualit√© de repr√©sentation des individus
cos2_ind <- res_acp$ind$cos2
qualite_ind <- data.frame(
  NomDep = data$NomDep,
  Cos2_Axe1 = round(cos2_ind[,1], 3),
  Cos2_Axe2 = round(cos2_ind[,2], 3),
  Qualite_Totale = round(rowSums(cos2_ind[,1:2]), 3)
)

# D√©partements bien repr√©sent√©s (cos¬≤ total > 0.7)
departements_biens_representes <- qualite_ind %>%
  filter(Qualite_Totale > 0.7) %>%
  arrange(desc(Qualite_Totale))

cat("D√©partements bien repr√©sent√©s (cos¬≤ > 0.7) :", 
    nrow(departements_biens_representes), "/", nrow(data), "\n")

# Graphique avec qualit√© de repr√©sentation
plot_individus_qualite <- fviz_pca_ind(res_acp,
                                       col.ind = "cos2",
                                       gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
                                       repel = FALSE,
                                       alpha.ind = 0.7,
                                       title = "Projection des d√©partements - Qualit√© de repr√©sentation",
                                       subtitle = "Couleur selon cos¬≤ (qualit√© de projection sur le plan 1-2)") +
  theme_minimal()

print(plot_individus_qualite)
```

##  Interpr√©tation de la projection des d√©partements

**Positionnement territorial sur le plan factoriel :**

### **Quadrant DROITE-HAUT**
- **Profil** : D√©partements √† forte densit√© d'√©quipement et orientation culturelle
- **Caract√©ristiques** : Nombreuses communes √©quip√©es, pr√©sence d'art et essai
- **Qualit√©** : Points oranges = bonne repr√©sentation

### **Quadrant DROITE-BAS**
- **Profil** : Grandes agglom√©rations tr√®s √©quip√©es
- **Caract√©ristiques** : Forte population, multiplexes, haute fr√©quentation
- **Exemples** : Paris, grandes m√©tropoles r√©gionales

### **Quadrant GAUCHE-HAUT**
- **Profil** : Territoires ruraux avec cin√©ma de proximit√©
- **Caract√©ristiques** : Faible population mais bonne couverture territoriale

### **Quadrant GAUCHE-BAS**
- **Profil** : D√©partements peu √©quip√©s
- **Caract√©ristiques** : Faible densit√© d'√©quipement et de fr√©quentation

**Qualit√© de repr√©sentation :**
- `r nrow(departements_biens_representes)` d√©partements sur `r nrow(data)` bien repr√©sent√©s (cos¬≤ > 0.7)
- Couleurs chaudes = excellente qualit√© de projection
- Couleurs froides = repr√©sentation moins pr√©cise



```{r synthese-acp, fig.height=8, fig.width=12, echo=FALSE}
# --- CLASSIFICATION HI√âRARCHIQUE ASCENDANTE ---
#cat("\n CLASSIFICATION HI√âRARCHIQUE\n")

# Calcul des distances sur les coordonn√©es factorielles
coords_axes <- res_acp$ind$coord[,1:n_axes_kaiser]
dist_mat <- dist(coords_axes)

# CAH avec crit√®re de Ward
cah <- hclust(dist_mat, method = "ward.D2")

# D√©coupage en 4 groupes (arbitraire mais interpr√©table)
groupes_cah <- cutree(cah, k = 4)
data$groupe_cah <- groupes_cah

# --- ‚É£ CARACT√âRISATION DES GROUPES ---
#cat("\n PROFILS DES GROUPES\n")

profils_groupes <- data %>%
  group_by(groupe_cah) %>%
  summarise(
    n_dep = n(),
    Pop_moyenne = round(mean(Pop, na.rm = TRUE), 2),
    Entr_moyenne = round(mean(Entr, na.rm = TRUE), 2),
    Salle_moyenne = round(mean(Salle, na.rm = TRUE), 1),
    Artes_moyen = round(mean(Artes, na.rm = TRUE), 1),
    Multi_moyen = round(mean(Multi, na.rm = TRUE), 1),
    Rece_moyenne = round(mean(Rece, na.rm = TRUE), 2)
  )

#cat("Caract√©risation des 4 groupes :\n")
#print(profils_groupes)

# ---  VISUALISATION ACP + GROUPES ---
#cat("\n VISUALISATION SYNTH√àSE\n")

# Biplot avec groupes CAH
plot_synthese <- fviz_pca_biplot(res_acp,
                                 geom.ind = "point",
                                 habillage = as.factor(data$groupe_cah),
                                 addEllipses = TRUE,
                                 ellipse.type = "convex",
                                 ellipse.level = 0.95,
                                 col.var = "black",
                                 alpha.var = 0.7,
                                 repel = TRUE,
                                 title = paste("Typologie int√©gr√©e - ACP + Classification (", 
                                               variance_axes_1_2, "% variance expliqu√©e)", sep = ""),
                                 subtitle = "Projection sur les axes 1-2 avec groupes CAH") +
  scale_color_manual(values = c("#2E9FDF", "#00AFBB", "#E7B800", "#FC4E07"),
                     name = "Groupes CAH") +
  theme_minimal()

print(plot_synthese)
```

##  Interpr√©tation de la typologie int√©gr√©e ACP + Classification

### **Groupe 1 (Bleu) - "M√©tropoles cin√©philes"**
- **Position** : Extr√™me droite du graphique
- **Caract√©ristiques** : Forte population, √©quipement important, haute fr√©quentation
- **√âquipement** : Multiplexes dominants, nombreuses salles
- **Performance** : Recettes √©lev√©es

### **Groupe 2 (Turquoise) - "Agglom√©rations √©quilibr√©es"**
- **Position** : Centre-droit
- **Caract√©ristiques** : Population moyenne, bon √©quipement, fr√©quentation soutenue
- **√âquipement** : Mixit√© multiplexes/art et essai
- **Performance** : Recettes correctes

### **Groupe 3 (Jaune) - "Territoires de proximit√©"**
- **Position** : Centre-gauche
- **Caract√©ristiques** : Faible population mais bonne densit√© d'√©quipement
- **√âquipement** : Cin√©ma art et essai, √©tablissements de proximit√©
- **Performance** : Fr√©quentation mod√©r√©e

### **Groupe 4 (Rouge) - "D√©serts cin√©matographiques"**
- **Position** : Extr√™me gauche
- **Caract√©ristiques** : Tr√®s faible population et √©quipement
- **√âquipement** : Tr√®s limit√©, peu de multiplexes
- **Performance** : Faible fr√©quentation et recettes

##  Synth√®se globale 

**Structure bipolaire du paysage cin√©matographique :**  
- **Axe majeur** : Opposition m√©tropoles √©quip√©es vs territoires ruraux  
- **Axe secondaire** : Diff√©renciation des mod√®les d'exploitation




**Conclusion** : L'ACP r√©v√®le une structuration claire du territoire cin√©matographique fran√ßais, permettant une compr√©hension fine des dynamiques √† l'≈ìuvre et une aide pr√©cieuse √† la d√©cision pour l'ensemble des acteurs du secteur.


